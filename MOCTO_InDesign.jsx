/* ——————————————————————————————*                                                                                       *   NYC Mayor's Office of the CTO*   Community Profiles InDesign Automation                *   by ALEX CHEN**   https://tech.cityofnewyork.us/**	See https://docs.google.com/document/d/12_EYPveaweZE6aqwaQqNR2sg6BRnNpny8E1LDotbV-M/edit?usp=sharing*   for Adobe Automation Guide** ——————————————————————————————*/ // Instead of using an XML file I just pasted all spreadsheet data into the parallel arrays below// https://delim.co/ is a free comma separating tool, it helps a lot// Not the prettiest solution but probably the most efficient! var SAD_DISTRICTS = [23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87]; var SAD_NO_BB = [30,25,26,21,27,23,35,24,29,38,28,26,29,22,26,27,29,39,25,30,33,28,31,31,29,47,30,33,31,16,38,39,41,40,26,30,23,35,31,20,23,24,33,17,18,36,22,33,31,35,15,25,16,16,42,41,42,35,32,31,35,42,38,42,34]; var SAD_NO_MOBILE_BB = [31,26,30,28,31,28,27,26,26,27,27,25,30,24,25,25,29,38,33,31,34,29,38,36,31,45,31,29,29,17,28,27,30,29,24,30,28,31,34,27,29,30,29,16,18,33,22,31,29,30,17,23,17,18,32,29,35,29,31,31,32,33,32,30,31];var SAD_PCC = [13,5,8,9,8,9,8,7,6,9,5,0,9,3,12,4,7,6,5,2,5,7,8,10,3,6,3,6,6,7,10,6,11,14,11,4,5,12,9,5,8,5,10,9,8,18,10,12,10,8,6,8,13,5,7,4,16,9,11,10,9,11,6,6,6];var SAD_WORKSTATIONS = [234,85,131,95,139,130,225,84,157,133,103,0,235,73,218,44,94,198,135,26,175,121,86,157,57,97,23,75,86,106,193,92,216,231,367,52,94,164,351,135,170,89,206,263,304,363,224,334,171,251,225,175,690,108,133,302,308,238,257,272,154,198,173,250,226];var SAD_TRAINING = [41.4,11.9,51.5,14.6,14.7,52.1,62.4,20.1,50.9,37.3,14.9,0,11.9,12.4,30.9,5.1,19.3,24.7,33,7.2,20.1,20,48.7,29.4,14.1,31.3,7.1,42.6,30.1,15.7,66.2,19.5,66,91.2,100.4,15.5,21.7,70.9,73.8,16.5,44.8,13,65.3,54.7,39.3,36.9,24.3,112.3,54.5,40.3,42.9,41.5,153.6,30.5,34.1,51.1,57.8,27.4,44.2,44.4,52.8,43.7,40.7,26.1,83.2];var SAD_WIFI = [38,27,23,6,15,54,33,46,3,40,5,23,21,46,77,25,38,11,3,26,39,22,18,43,10,9,1,48,38,188,47,19,22,32,98,5,11,16,25,14,18,48,123,151,147,98,122,180,99,42,212,99,344,54,28,31,46,8,19,29,14,91,6,38,6];var SSD_DISTRICTS = [10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,36];var SSD_NO_BB = [32,24,24,29,31,25,29,35,37,30,32,27,27,32,22,31,30,19,15,32,33,27,39,40,33,35];var SSD_NO_MOBILE_BB = [26,28,24,28,27,28,31,37,27,31,30,28,31,36,29,24,27,18,17,27,30,25,33,30,30,31];var SSD_WIFI = [61,37,154,49,69,76,85,14,86,25,76,67,41,67,74,284,241,501,364,186,354,182,45,109,42,29];var SSD_WORKSTATIONS = [490,195,277,251,398,258,509,288,345,300,250,442,177,599,273,540,487,1184,328,564,872,307,676,616,465,410];var SSD_PCC = [23,17,15,16,16,20,21,16,23,19,11,14,12,24,12,32,21,27,12,25,37,16,25,14,22,18];var SSD_TRAINING = [118,31.2,43.8,31.3,86.8,50.1,114.9,86.3,117.2,100.4,66.2,96.2,43.4,141.7,53.6,162.6,152.2,219.9,59.4,106.9,199.2,63.5,148.2,86.7,110.9,85.9];var CD_DISTRICTS = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]; var CD_NO_BB = [27,26,17,17,16,18,30,42,36,35,33,34,33,40,42,42,41,34,23,37,32,23,22,27,26,23,36,32,24,25,34,25,29,34,27,38,38,31,22,32,40,36,25,42,29,24,33,30,31,23,20];var CD_NO_MOBILE_BB = [25,23,17,18,17,19,27,35,33,30,29,32,30,30,30,34,33,32,30,37,31,24,27,28,27,23,27,26,28,27,28,27,26,26,26,29,25,31,23,33,32,31,28,42,32,30,36,40,35,30,26];var CD_WIFI = [174,203,298,275,68,172,158,123,215,54,20,15,33,51,31,23,70,4,12,23,29,51,20,14,52,109,45,30,59,17,16,53,186,53,102,46,32,37,63,41,14,18,24,9,11,11,34,20,32,59,9];var CD_WORKSTATIONS = [345,258,247,754,136,363,272,368,461,272,243,241,355,231,430,257,329,263,118,250,171,83,130,120,158,234,289,155,139,104,306,121,131,196,412,259,88,90,145,127,229,196,134,106,62,89,110,213,429,176,106];var CD_PCC = [13,12,11,11,7,10,12,17,21,10,12,11,14,6,9,13,13,10,9,9,10,4,10,7,6,14,11,10,9,7,12,10,8,11,11,16,5,7,8,6,13,14,9,7,5,5,9,9,12,8,5];var CD_TRAINING = [92.9,58.8,93.7,117.3,32.5,40.3,38.1,47,158.6,45.3,53.6,58.6,53.8,49.9,38.1,56.5,67.2,99.4,12.1,63.4,22.5,12.4,29.5,17.5,8.7,38.8,68.5,34.2,53,14.2,89.5,11.8,44.9,53.1,101.9,96.8,29.6,30.1,31.9,18,72,82.1,31.1,32.5,16,19.7,35.3,62.7,97.7,27.1,16.3];var curDistrict = "";var myDocument = app.documents.item(0); var TEMPLATE_SPREAD = myDocument.spreads.item(25); // Spread 25 is the template// --- IMPORTANT --- MAKE SURE curDistrict IS SET CORRECTLY ------------------------var D_START = 2; // Change this to determine which districts to create! var D_END = 5; // Change this too! E.g. this currently creates 4 new spreads for districts 2, 3, 4, and 5// --- IMPORTANT --- MAKE SURE curDistrict IS SET CORRECTLY ------------------------for (var cd = D_START; cd <= D_END; cd++) {	curDistrict = cd + "";	var newSpread = TEMPLATE_SPREAD.duplicate(LocationOptions.AFTER, app.layoutWindows[0].activeSpread);	var curPage1 = newSpread.pages.item(0); 	var curPage2 = newSpread.pages.item(1);	// Below is the process of identifying which page items are which	// There should be an easier way (with XML tag or script label?)	// alert(curPage1.pageItems.length);	/* curPage2.pageItems.item(10).remove(); // Council District xx Data	curPage2.pageItems.item(7).remove(); // Mobile map	curPage2.pageItems.item(6).remove(); // Home map	curPage2.pageItems.item(4).remove(); // Fiber map	curPage2.pageItems.item(3).remove(); // Training	curPage2.pageItems.item(2).remove(); // PCC	curPage2.pageItems.item(1).remove(); // Wifi	curPage2.pageItems.item(0).remove(); // Workstations */	// alert(curPage1.pageItems.item(0).textFrames.length);		/* curPage1.pageItems.item(6).remove(); // Mobile BB	curPage1.pageItems.item(5).remove(); // Home BB	curPage1.pageItems.item(4).remove(); // Council District xx	curPage1.pageItems.item(3).remove(); // Council District xx at top	curPage1.pageItems.item(2).remove(); // Basemap */	// Replace the base map on the first page	var curBaseURL = "/Users/alexchen/Desktop/Broadband\ Community\ Profiles/ID_CP_CouncilDistricts_EV_v01/Links/CD_" + curDistrict + "_basic.png"; 	curPage1.pageItems.item(2).allGraphics[0].itemLink.relink(new File(curBaseURL));	// Replace the fiber map on the back page	var curBaseURL2 = "/Users/alexchen/Desktop/Broadband\ Community\ Profiles/ID_CP_CouncilDistricts_EV_v01/Links/CD_" + curDistrict + "_fiber.png"; 	curPage2.pageItems.item(4).allGraphics[0].itemLink.relink(new File(curBaseURL2));	// Replace the mobile map on the back page	var curBaseURL3 = "/Users/alexchen/Desktop/Broadband\ Community\ Profiles/ID_CP_CouncilDistricts_EV_v01/Links/CD_" + curDistrict + "_mobile.png"; 	curPage2.pageItems.item(7).allGraphics[0].itemLink.relink(new File(curBaseURL3));	// Replace the home map on the back page	var curBaseURL4 = "/Users/alexchen/Desktop/Broadband\ Community\ Profiles/ID_CP_CouncilDistricts_EV_v01/Links/CD_" + curDistrict + "_home.png"; 	curPage2.pageItems.item(6).allGraphics[0].itemLink.relink(new File(curBaseURL4));	// Get stats	var curBB = "XX%"; 	var curMobileBB = "XX%";	var curWifi = "X"; 	var curWorkstations = "XXX"; 	var curTraining = "XX.X"; 	var curPCC = "X";	for (var j = 0; j < CD_DISTRICTS.length; j++) {		if (CD_DISTRICTS[j] + "" == curDistrict + "") {			curBB = CD_NO_BB[j] + "%";			curMobileBB = CD_NO_MOBILE_BB[j] + "%"; 			curWifi = CD_WIFI[j] + "";			curWorkstations = CD_WORKSTATIONS[j] + ""; 			curTraining = CD_TRAINING[j] + ""; 			curPCC = CD_PCC[j] + ""; 			break;		}	}	with(curPage1) {		// Change district number references		var p1 = pageItems.item(3).paragraphs.item(0); 		p1.contents = "COUNCIL DISTRICT " + curDistrict;		var p2 = pageItems.item(4);		p2.contents = "COUNCIL DISTRICT " + curDistrict;		// p2.texts.item(0).leading = 15;		// Change stats		var p4 = pageItems.item(5); 		p4.contents = curBB;		var p5 = pageItems.item(6); 		p5.contents = curMobileBB;	} 	with(curPage2) {		// Change district number references		var p3 = pageItems.item(10).paragraphs.item(0); 		p3.contents = "COUNCIL DISTRICT " + curDistrict + " DATA";		// Replace stats		var p6 = pageItems.item(3).textFrames.item(0); // Training		p6.contents = curTraining;		var p7 = pageItems.item(2).textFrames.item(0); // PCC		p7.contents = curPCC;		var p8 = pageItems.item(1).textFrames.item(0); // Wifi		p8.contents = curWifi;		var p9 = pageItems.item(0).textFrames.item(0); // Workstations		p9.contents = curWorkstations;			} }alert("Created spreads for districts " + D_START + " through " + D_END);